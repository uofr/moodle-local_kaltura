{"version":3,"sources":["../src/modal_kaltura_upload.js"],"names":["templates","media","record","titles","ModalKalturaUpload","root","getRoot","on","ModalEvents","hidden","setBody","KalturaEvents","uploadModalClose","type","contextid","KalturaAjax","getUploadModalData","data","renderPromise","Templates","render","title","setTitle","show","Modal","registered","ModalRegistry","register","getType"],"mappings":"iUAuBA,OAIA,OACA,OACA,OAEA,OACA,O,44DAEMA,CAAAA,CAAS,CAAG,CACdC,KAAK,CAAE,iCADO,CAEdC,MAAM,CAAE,kCAFM,C,CAKZC,CAAM,CAAG,CACXF,KAAK,CAAE,cADI,CAEXC,MAAM,CAAE,eAFG,C,CAUME,C,oBAMjB,WAAYC,CAAZ,CAAkB,wCACRA,CADQ,EAEjB,C,0EAKwB,YACrB,2DAEA,KAAKC,OAAL,GAAeC,EAAf,CAAkBC,UAAYC,MAA9B,CAAsC,UAAM,CACxC,CAAI,CAACC,OAAL,CAAa,EAAb,EACA,cAAQC,UAAcC,gBAAtB,CACH,CAHD,CAKH,C,sFAOsBC,C,CAAMC,C,4GACNC,WAAYC,kBAAZ,CAA+BF,CAA/B,C,QAAbG,C,QAEAC,C,CAAgBC,UAAUC,MAAV,CAAiBpB,CAAS,CAACa,CAAD,CAA1B,CAAkCI,CAAlC,C,CACtB,KAAKP,OAAL,CAAaQ,CAAb,E,eAEoB,iBAAUf,CAAM,CAACU,CAAD,CAAhB,CAAwB,eAAxB,C,QAAdQ,C,QACN,KAAKC,QAAL,CAAcD,CAAd,EAEA,KAAKE,IAAL,G,iKAOa,CACb,MAAO,oCACV,C,cA9C2CC,S,cAkDhD,GAAIC,CAAAA,CAAU,GAAd,CACA,GAAI,CAACA,CAAL,CAAiB,CACbC,UAAcC,QAAd,CAAuBvB,CAAkB,CAACwB,OAAnB,EAAvB,CAAqDxB,CAArD,CAAyE,oCAAzE,EACAqB,CAAU,GACb,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Modal for displaying kaltura upload forms.\n *\n * @module local_kaltura/modal_kaltura_upload\n * @package local_kaltura\n * @author John Lane\n */\n\nimport Templates from 'core/templates';\nimport {get_string as getString} from 'core/str';\nimport {publish} from 'core/pubsub';\n\nimport Modal from 'core/modal';\nimport ModalRegistry from 'core/modal_registry';\nimport ModalEvents from 'core/modal_events';\n\nimport KalturaAjax from 'local_kaltura/kaltura_ajax';\nimport KalturaEvents from 'local_kaltura/kaltura_events';\n\nconst templates = {\n    media: 'local_kaltura/upload_form_media',\n    record: 'local_kaltura/upload_form_record'\n};\n\nconst titles = {\n    media: 'media_upload',\n    record: 'webcam_upload'\n};\n\n/**\n * Kaltura upload modal class.\n *\n * @class ModalKalturaUpload\n */\nexport default class ModalKalturaUpload extends Modal {\n\n    /**\n     * Constructor.\n     * @param {String} root\n     */\n    constructor(root) {\n        super(root);\n    }\n\n    /**\n     * Event listener setup.\n     */\n    registerEventListeners() {\n        super.registerEventListeners();\n\n        this.getRoot().on(ModalEvents.hidden, () => {\n            this.setBody('');\n            publish(KalturaEvents.uploadModalClose);\n        });\n\n    }\n\n    /**\n     * Renders the specified upload form.\n     * @param {String} type - Type of upload form to render (media, recording, youtube, etc).\n     * @param {Number} contextid\n     */\n    async renderUploadForm(type, contextid) {\n        const data = await KalturaAjax.getUploadModalData(contextid);\n\n        const renderPromise = Templates.render(templates[type], data);\n        this.setBody(renderPromise);\n\n        const title = await getString(titles[type], 'local_kaltura');\n        this.setTitle(title);\n\n        this.show();\n    }\n\n    /**\n     * Returns modal type. Used for creating modal using core/modal_factory.\n     * @returns {String}\n     */\n    static getType() {\n        return 'local_kalutra_modal_kaltura_upload';\n    }\n\n}\n\nlet registered = false;\nif (!registered) {\n    ModalRegistry.register(ModalKalturaUpload.getType(), ModalKalturaUpload, 'local_kaltura/modal_kaltura_upload');\n    registered = true;\n}\n"],"file":"modal_kaltura_upload.min.js"}